<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="/admin/layout"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Category</title>
  </head>

  <body>
    <div class="category category-update" layout:fragment="content">
      <div class="container-fluid">
        <!-- breadcrumb -->
        <ul class="breadcrumb">
          <li><a href="/dashboard">Bảng điều khiển</a></li>
          <li><a href="/dashboard/category">Danh mục</a></li>
          <li>
            <a
              th:href="@{/dashboard/category/details/{id}(id=${updateCategoryDto.id})}"
              th:text="${updateCategoryDto.id}"
            ></a>
          </li>
          <li>Cập nhật</li>
        </ul>

        <!-- update category form -->
        <form
          class="update-category-form category-form"
          method="post"
          th:action="@{/dashboard/category/update}"
          th:object="${updateCategoryDto}"
          enctype="multipart/form-data"
        >
          <h1 class="form-title">
            Cập nhật danh mục với "Mã:
            <span th:text="${updateCategoryDto.id}"></span>"
          </h1>

          <div class="form-content">
            <div class="input-group">
              <label for="image">Hình ảnh (JPG, PNG, JPEG, GIF, WebP):</label>
              <div class="image-input-group">
                <div class="image-upload-group">
                  <!-- upload preview -->
                  <div class="image-upload-preview">
                    <div
                      class="image-preview"
                      th:if="${updateCategoryDto.currentImageName == null or updateCategoryDto.currentImageName.isEmpty()}"
                    >
                      <label class="image-preview-edit-button" for="image"
                        ><i class="fa-solid fa-pen-to-square"></i
                      ></label>
                      <img
                        class="image-preview-image"
                        src="/images/default-thumbnail.jpg"
                        alt="category"
                      />
                    </div>
                    <div
                      class="image-preview"
                      th:if="${updateCategoryDto.currentImageName != null and !updateCategoryDto.currentImageName.isEmpty()}"
                    >
                      <label class="image-preview-edit-button" for="image"
                        ><i class="fa-solid fa-pen-to-square"></i
                      ></label>
                      <img
                        class="image-preview-image"
                        th:src="${'/' + resourcesMappingFolder + '/' + categoryPicturesFolder + '/' + updateCategoryDto.currentImageName}"
                        alt="category"
                      />
                    </div>
                  </div>

                  <!-- upload control -->
                  <div class="image-upload-control">
                    <label class="image-upload-label" for="image">
                      <i class="fa-solid fa-plus"></i>
                    </label>
                    <input
                      class="image-upload-input"
                      name="newImage"
                      id="image"
                      type="file"
                      th:classappend="${#fields.hasErrors('newImage') ? 'error' : ''}"
                      th:field="${updateCategoryDto.newImage}"
                      accept="image/jpg, image/png, image/jpeg, image/gif, image/webp"
                    />
                  </div>
                </div>
                <span
                  class="input-error-message"
                  th:if="${#fields.hasErrors('newImage')}"
                  th:errors="${updateCategoryDto.newImage}"
                ></span>
              </div>
            </div>

            <input type="hidden" name="id" th:value="${updateCategoryDto.id}" />
            <input
              type="hidden"
              name="currentImageName"
              th:value="${updateCategoryDto.currentImageName}"
            />

            <div class="input-group">
              <label for="name">Tên:</label>
              <div class="input-group-control">
                <input
                  type="text"
                  name="name"
                  id="name"
                  th:value="${updateCategoryDto.name}"
                  placeholder="Tên danh mục"
                  required
                  th:classappend="${#fields.hasErrors('name') ? 'error' : ''}"
                  th:field="${updateCategoryDto.name}"
                />
                <span
                  class="input-error-message"
                  th:if="${#fields.hasErrors('name')}"
                  th:errors="${updateCategoryDto.name}"
                ></span>
              </div>
            </div>

            <div class="input-group">
              <label for="description">Mô tả:</label>
              <div class="input-group-control">
                <textarea
                  name="description"
                  id="description"
                  rows="5"
                  th:text="${updateCategoryDto.description}"
                  placeholder="Mô tả danh mục"
                  th:classappend="${#fields.hasErrors('description') ? 'error' : ''}"
                  th:field="${updateCategoryDto.description}"
                ></textarea>
                <span
                  class="input-error-message"
                  th:if="${#fields.hasErrors('description')}"
                  th:errors="${updateCategoryDto.description}"
                ></span>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <div class="spacer"></div>
            <button type="submit" class="save-button primary-button">
              Lưu
            </button>
            <a href="/dashboard/category" class="back-button secondary-button"
              >Quay lại</a
            >
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
